<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Consulta dos Pais</title>
</head>
<body>
    <h1>Teste da Consulta dos Pais</h1>
    
    <div>
        <h2>Teste de Carregamento de Dados</h2>
        <button onclick="testarCarregamentoDados()">Testar Carregamento</button>
        <div id="resultadoDados"></div>
    </div>
    
    <div>
        <h2>Teste de Busca de Aluno</h2>
        <input type="text" id="codigoTeste" placeholder="C√≥digo do aluno (ex: 2639458)" value="2639458">
        <button onclick="testarBuscaAluno()">Buscar Aluno</button>
        <div id="resultadoBusca"></div>
    </div>
    
    <div>
        <h2>Teste de Frequ√™ncia</h2>
        <button onclick="testarFrequencia()">Testar Frequ√™ncia</button>
        <div id="resultadoFrequencia"></div>
    </div>

    <script>
        async function testarCarregamentoDados() {
            const resultado = document.getElementById('resultadoDados');
            resultado.innerHTML = 'Carregando...';
            
            try {
                const response = await fetch('./data/db.json');
                const data = await response.json();
                const alunos = Object.values(data.alunos || {});
                
                resultado.innerHTML = `
                    <p>‚úÖ Dados carregados com sucesso!</p>
                    <p>Total de alunos: ${alunos.length}</p>
                    <p>Primeiro aluno: ${alunos[0].nome_completo} (${alunos[0].codigo})</p>
                `;
            } catch (error) {
                resultado.innerHTML = `‚ùå Erro: ${error.message}`;
            }
        }
        
        async function testarBuscaAluno() {
            const codigo = document.getElementById('codigoTeste').value;
            const resultado = document.getElementById('resultadoBusca');
            resultado.innerHTML = 'Buscando...';
            
            try {
                const response = await fetch('./data/db.json');
                const data = await response.json();
                const alunos = Object.values(data.alunos || {});
                const aluno = alunos.find(a => a.codigo === codigo);
                
                if (aluno) {
                    resultado.innerHTML = `
                        <p>‚úÖ Aluno encontrado!</p>
                        <p>Nome: ${aluno.nome_completo}</p>
                        <p>C√≥digo: ${aluno.codigo}</p>
                        <p>Turma: ${aluno.turma}</p>
                        <p>Respons√°vel: ${aluno.responsavel}</p>
                    `;
                } else {
                    resultado.innerHTML = `‚ùå Aluno n√£o encontrado para o c√≥digo: ${codigo}`;
                }
            } catch (error) {
                resultado.innerHTML = `‚ùå Erro: ${error.message}`;
            }
        }
        
        async function testarFrequencia() {
            const resultado = document.getElementById('resultadoFrequencia');
            resultado.innerHTML = 'Carregando frequ√™ncia...';
            
            try {
                const response = await fetch('./assets/js/dados-frequencia-agosto.js');
                const jsContent = await response.text();
                
                // Extrair dados CSV
                const csvMatch = jsContent.match(/const dadosCSV = `([^`]+)`/);
                if (csvMatch && csvMatch[1]) {
                    const csvData = csvMatch[1];
                    const linhas = csvData.trim().split('\n');
                    
                    resultado.innerHTML = `
                        <p>‚úÖ Dados de frequ√™ncia carregados!</p>
                        <p>Total de linhas: ${linhas.length}</p>
                        <p>Primeira linha: ${linhas[0].substring(0, 100)}...</p>
                    `;
                } else {
                    resultado.innerHTML = '‚ùå Dados CSV n√£o encontrados no arquivo';
                }
            } catch (error) {
                resultado.innerHTML = `‚ùå Erro: ${error.message}`;
            }
        }
        
        // Teste autom√°tico ao carregar a p√°gina
        window.addEventListener('load', function() {
            console.log('üöÄ P√°gina de teste carregada');
            testarCarregamentoDados();
        });
    </script>
</body>
</html>